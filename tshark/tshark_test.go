package tshark

import (
	"crypto/x509"
	"encoding/hex"
	"fmt"
	"strings"
	"testing"
)

func TestTshark(t *testing.T) {
	code := `
www.karesse.com.cn
        308204e8308202d0a00302010202141b2601b2687d4e86372bc2f22e3ada3028fe378e300d06092a864886f70d01010b050030818e310b300906035504061302494c310f300d06035504080c0643656e746572310c300a06035504070c034c6f643110300e060355040a0c07476f50726f78793110300e060355040b0c07476f50726f7879311a301806035504030c11676f70726f78792e6769746875622e696f3120301e06092a864886f70d0109011611656c617a61726c40676d61696c2e636f6d301e170d3233303531353037313931305a170d3233303531353039313931305a303531163014060355040a130d4d61727469616e2050726f7879311b3019060355040313127777772e6b6172657373652e636f6d2e636e30820122300d06092a864886f70d01010105000382010f003082010a0282010100a3904c1b763fe766fb4ad3a7584fb35a5c391374a91c90ab2f4726502b8e0dd6fceef939ab1d05f3e4c2e3d7ac492e7a79b9532c80a5e18513ebe6551604d31dc96e8b8fe7a3392f66ba5754fbd246d2cac10e3f1c9b346db6ea62c6c0c9469ae805e7f541ca388ed665bfb0976bac5050c4a70be9753ccabbd974dbc1b3f2f8ecb6756852c33dc34922c6534246afdf2cf6b0d01357a2dbe333f099dad056ac0a80a6de8afe878a949a544dec6a6071af3b5b84a31ca793ebd35a296ab9c027e7b9ece3b5cc9cb044d02c7ee8715025a1e5efc12f595650f45326180bf74e478c99f82a3352705f1c57ad949cdcf9bb627ae91e53ecbe5c8063ae8a25d650c70203010001a38195308192300e0603551d0f0101ff0404030205a030130603551d25040c300a06082b06010505070301300c0603551d130101ff04023000301d0603551d0e04160414cc703be736ba68752dfc4551e109e70a4d8ff6bd301f0603551d2304183016801478b830fd63ac7b894a073bedf68a839cc3520265301d0603551d110416301482127777772e6b6172657373652e636f6d2e636e300d06092a864886f70d01010b050003820201003c20b3537a61b11530da65aed627e1034a93455673da9ecd932ac807900086e4a91175025313958a93b98a64c6c188ff8e78af0eb8d1a81577b9558945449d5e8778d687fc96e3b960ba1ab62c503a355d5c73179bdb401d9f3d3b700561869315288abd0e441ef70d4bb41498629b761ed58a32cf9c926468956be8a6502418ca35e61da0395eba132ada93d2a311eabeff0c4790a9e1aad7bf194c8495467a5854bfea438610a880f39b3758515c377a23508a939452a96bf8d3ae3f95d852e683393f8560bfa555a6981feea6cabaa11ed3b2a426a6336a67fcb152223ca70ffe2f33a634de855b2fefe4c1436936c8d98aeb953bb0f5fc41cd5f52c909987897cf7f58af40463bee5252ccea0e309ec8093b1989d0dc50e4cd4e90356c620fe080a2149a6af71ad319bbb5cf49e1693ee839cee6f85f01a4c0794efc2f851254b2d428bad1a0fb43c9a2fcf7387c04fff655350aaadb04e11bc970219808073c41144bccccf5f854c9e66abbb2a5f53e8f9923c83e8ed679111c541875274eaeb6a2162e985fc4fb942a0922da13ca51509b83e823283bfd89d424d34f09c338e64cdbd726352073d06746ab198b9983372b1788f83c7997ff3e87897d8e658195273ac87a60d65125bdd391f4b9589cf571fbddaa73a127b06647ed92fa35e673193b8b70ce7355e9152c054cbd97ef6554c3c8ae23f6a93e588f0eeb60,308205f4308203dca003020102020900e0ea614c28563264300d06092a864886f70d01010b050030818e310b300906035504061302494c310f300d06035504080c0643656e746572310c300a06035504070c034c6f643110300e060355040a0c07476f50726f78793110300e060355040b0c07476f50726f7879311a301806035504030c11676f70726f78792e6769746875622e696f3120301e06092a864886f70d0109011611656c617a61726c40676d61696c2e636f6d301e170d3137303430353230303031305a170d3337303333313230303031305a30818e310b300906035504061302494c310f300d06035504080c0643656e746572310c300a06035504070c034c6f643110300e060355040a0c07476f50726f78793110300e060355040b0c07476f50726f7879311a301806035504030c11676f70726f78792e6769746875622e696f3120301e06092a864886f70d0109011611656c617a61726c40676d61696c2e636f6d30820222300d06092a864886f70d01010105000382020f003082020a02820201009e10cbe1fa861a18d6cd1045cbc8871ae348768efd16da163debc2a727a4e805ab4ee045d23dddcd1314a4091e982fe9f78b46112f5ff62594562ee09df994cf59718638aa5285b92b5c5fc266f1faa982d980301ccfb2ab6a0e2f0cf5140628437353d2053a7095ed201e878e6c70cb88df0cfcc2b8c1707ef3aae1e4bea512619cf4df9b7d57a593ac7c9312f4f8c3e9453953766c0ffa0c0231ae306217a0e1a09aa785ad1266d0dfbfbed7a70186dc4840feaa2186262b0ebb982bbcc97444902f8e0bc3330fba956282a6a57eff981df4236e14fde75215bab5b6349811c8113ad9d2eb94761db53f6d0930ab77e28934c27e8e9f61023748bb506bfe489f538178fb864b311f547a38b41a490f2ac61dc8c9ea8f4a743e8832bcfd65e2a99ba0f226318b5aa05b9898c62579b802f4b375d1b2fdd4ae3e8cbb74235627b44cebaa02685ac273b580f0e78dcdcd2cb95befdcab85d1620b6ad5bd115b0b948acc1ece63287b21d9f014097b6c4c8c03a59404837ea6bc38add60011c9a72e3352b9d406232e3c84f30ff16e0f1e02e48c30942ebc8070196e536aa416425f49c50ad2a360e708d92a391db436382f1017ecc656e76e1d44a8938852cb60417d9d697efce2a8179eb5627016f6a9181e389c81e158a34abea3b12cd232edef931918963a89ab016335f15491f4b65b071a492bb3cb4b35aa6096134426470203010001a3533051301d0603551d0e0416041478b830fd63ac7b894a073bedf68a839cc3520265301f0603551d2304183016801478b830fd63ac7b894a073bedf68a839cc3520265300f0603551d130101ff040530030101ff300d06092a864886f70d01010b050003820201001a084ba9cc61aa71d87e2fb073857ef3c9def2cc0294a0bc45af1699637e17ca3de5731d57a0ae8502ab07d89336e468b181a77384db7dd893fbbf3a1678766d2dfb2dacf4badfc635cd98bab68cb8138f6f8988c59392740ba65c142d38558596c7acf41f026e012d3cb59dfb26e157a4919f5c93a3642432c6c7b42e0d2db8a2cc7970c293663705ad27a1eb8dc874685975cfca2528780a64542539808b328894963a3849e61a491b4eab40d7cd61ec602abaeb6848a7a348e610cb49331e53b43f378529cb0a7146041ab996413b8e05cc1352ac6c8137949673457d6643050af02243631c9e8ba33f7734afcb44ac3efcfc7d3025a6b5d1b565ad2509b181610da770effb43e6bb1fe5fa2964eca038b0c5c686c7eb6ef4ce796975feea054cf622591ff0c3b4043cbab6df20c5634e10ed49f4aa3224f04c6f698f250a45cc81cf22eec19855fbce61bd339baec47c0425dd35bc2b2e5f97909cc695420f7eb40738ba8708d88b16b7a847818203a2c454011567edf30ae42931e93905e39f8b033ed7adf229a6f54604b735ab157e93f4c158901474ff2c9ed05221f7e60f89303a581f3a3423702b9625e87baf17dec2207e427603bee42eca89f52da9338bf2940a6cdc32d12dec358bc1fa78c6bd1a51ee92950549c5a41fc0b69b6aaf80949535eb73920f2c0a807e6c24e4829cc32dc45d46ebb9ff43c33ebd60
www.karesse.com.cn
        308204e8308202d0a00302010202141b2601b2687d4e86372bc2f22e3ada3028fe378e300d06092a864886f70d01010b050030818e310b300906035504061302494c310f300d06035504080c0643656e746572310c300a06035504070c034c6f643110300e060355040a0c07476f50726f78793110300e060355040b0c07476f50726f7879311a301806035504030c11676f70726f78792e6769746875622e696f3120301e06092a864886f70d0109011611656c617a61726c40676d61696c2e636f6d301e170d3233303531353037313931305a170d3233303531353039313931305a303531163014060355040a130d4d61727469616e2050726f7879311b3019060355040313127777772e6b6172657373652e636f6d2e636e30820122300d06092a864886f70d01010105000382010f003082010a0282010100a3904c1b763fe766fb4ad3a7584fb35a5c391374a91c90ab2f4726502b8e0dd6fceef939ab1d05f3e4c2e3d7ac492e7a79b9532c80a5e18513ebe6551604d31dc96e8b8fe7a3392f66ba5754fbd246d2cac10e3f1c9b346db6ea62c6c0c9469ae805e7f541ca388ed665bfb0976bac5050c4a70be9753ccabbd974dbc1b3f2f8ecb6756852c33dc34922c6534246afdf2cf6b0d01357a2dbe333f099dad056ac0a80a6de8afe878a949a544dec6a6071af3b5b84a31ca793ebd35a296ab9c027e7b9ece3b5cc9cb044d02c7ee8715025a1e5efc12f595650f45326180bf74e478c99f82a3352705f1c57ad949cdcf9bb627ae91e53ecbe5c8063ae8a25d650c70203010001a38195308192300e0603551d0f0101ff0404030205a030130603551d25040c300a06082b06010505070301300c0603551d130101ff04023000301d0603551d0e04160414cc703be736ba68752dfc4551e109e70a4d8ff6bd301f0603551d2304183016801478b830fd63ac7b894a073bedf68a839cc3520265301d0603551d110416301482127777772e6b6172657373652e636f6d2e636e300d06092a864886f70d01010b050003820201003c20b3537a61b11530da65aed627e1034a93455673da9ecd932ac807900086e4a91175025313958a93b98a64c6c188ff8e78af0eb8d1a81577b9558945449d5e8778d687fc96e3b960ba1ab62c503a355d5c73179bdb401d9f3d3b700561869315288abd0e441ef70d4bb41498629b761ed58a32cf9c926468956be8a6502418ca35e61da0395eba132ada93d2a311eabeff0c4790a9e1aad7bf194c8495467a5854bfea438610a880f39b3758515c377a23508a939452a96bf8d3ae3f95d852e683393f8560bfa555a6981feea6cabaa11ed3b2a426a6336a67fcb152223ca70ffe2f33a634de855b2fefe4c1436936c8d98aeb953bb0f5fc41cd5f52c909987897cf7f58af40463bee5252ccea0e309ec8093b1989d0dc50e4cd4e90356c620fe080a2149a6af71ad319bbb5cf49e1693ee839cee6f85f01a4c0794efc2f851254b2d428bad1a0fb43c9a2fcf7387c04fff655350aaadb04e11bc970219808073c41144bccccf5f854c9e66abbb2a5f53e8f9923c83e8ed679111c541875274eaeb6a2162e985fc4fb942a0922da13ca51509b83e823283bfd89d424d34f09c338e64cdbd726352073d06746ab198b9983372b1788f83c7997ff3e87897d8e658195273ac87a60d65125bdd391f4b9589cf571fbddaa73a127b06647ed92fa35e673193b8b70ce7355e9152c054cbd97ef6554c3c8ae23f6a93e588f0eeb60,308205f4308203dca003020102020900e0ea614c28563264300d06092a864886f70d01010b050030818e310b300906035504061302494c310f300d06035504080c0643656e746572310c300a06035504070c034c6f643110300e060355040a0c07476f50726f78793110300e060355040b0c07476f50726f7879311a301806035504030c11676f70726f78792e6769746875622e696f3120301e06092a864886f70d0109011611656c617a61726c40676d61696c2e636f6d301e170d3137303430353230303031305a170d3337303333313230303031305a30818e310b300906035504061302494c310f300d06035504080c0643656e746572310c300a06035504070c034c6f643110300e060355040a0c07476f50726f78793110300e060355040b0c07476f50726f7879311a301806035504030c11676f70726f78792e6769746875622e696f3120301e06092a864886f70d0109011611656c617a61726c40676d61696c2e636f6d30820222300d06092a864886f70d01010105000382020f003082020a02820201009e10cbe1fa861a18d6cd1045cbc8871ae348768efd16da163debc2a727a4e805ab4ee045d23dddcd1314a4091e982fe9f78b46112f5ff62594562ee09df994cf59718638aa5285b92b5c5fc266f1faa982d980301ccfb2ab6a0e2f0cf5140628437353d2053a7095ed201e878e6c70cb88df0cfcc2b8c1707ef3aae1e4bea512619cf4df9b7d57a593ac7c9312f4f8c3e9453953766c0ffa0c0231ae306217a0e1a09aa785ad1266d0dfbfbed7a70186dc4840feaa2186262b0ebb982bbcc97444902f8e0bc3330fba956282a6a57eff981df4236e14fde75215bab5b6349811c8113ad9d2eb94761db53f6d0930ab77e28934c27e8e9f61023748bb506bfe489f538178fb864b311f547a38b41a490f2ac61dc8c9ea8f4a743e8832bcfd65e2a99ba0f226318b5aa05b9898c62579b802f4b375d1b2fdd4ae3e8cbb74235627b44cebaa02685ac273b580f0e78dcdcd2cb95befdcab85d1620b6ad5bd115b0b948acc1ece63287b21d9f014097b6c4c8c03a59404837ea6bc38add60011c9a72e3352b9d406232e3c84f30ff16e0f1e02e48c30942ebc8070196e536aa416425f49c50ad2a360e708d92a391db436382f1017ecc656e76e1d44a8938852cb60417d9d697efce2a8179eb5627016f6a9181e389c81e158a34abea3b12cd232edef931918963a89ab016335f15491f4b65b071a492bb3cb4b35aa6096134426470203010001a3533051301d0603551d0e0416041478b830fd63ac7b894a073bedf68a839cc3520265301f0603551d2304183016801478b830fd63ac7b894a073bedf68a839cc3520265300f0603551d130101ff040530030101ff300d06092a864886f70d01010b050003820201001a084ba9cc61aa71d87e2fb073857ef3c9def2cc0294a0bc45af1699637e17ca3de5731d57a0ae8502ab07d89336e468b181a77384db7dd893fbbf3a1678766d2dfb2dacf4badfc635cd98bab68cb8138f6f8988c59392740ba65c142d38558596c7acf41f026e012d3cb59dfb26e157a4919f5c93a3642432c6c7b42e0d2db8a2cc7970c293663705ad27a1eb8dc874685975cfca2528780a64542539808b328894963a3849e61a491b4eab40d7cd61ec602abaeb6848a7a348e610cb49331e53b43f378529cb0a7146041ab996413b8e05cc1352ac6c8137949673457d6643050af02243631c9e8ba33f7734afcb44ac3efcfc7d3025a6b5d1b565ad2509b181610da770effb43e6bb1fe5fa2964eca038b0c5c686c7eb6ef4ce796975feea054cf622591ff0c3b4043cbab6df20c5634e10ed49f4aa3224f04c6f698f250a45cc81cf22eec19855fbce61bd339baec47c0425dd35bc2b2e5f97909cc695420f7eb40738ba8708d88b16b7a847818203a2c454011567edf30ae42931e93905e39f8b033ed7adf229a6f54604b735ab157e93f4c158901474ff2c9ed05221f7e60f89303a581f3a3423702b9625e87baf17dec2207e427603bee42eca89f52da9338bf2940a6cdc32d12dec358bc1fa78c6bd1a51ee92950549c5a41fc0b69b6aaf80949535eb73920f2c0a807e6c24e4829cc32dc45d46ebb9ff43c33ebd60
www.karesse.com.cn
        308204e8308202d0a00302010202141b2601b2687d4e86372bc2f22e3ada3028fe378e300d06092a864886f70d01010b050030818e310b300906035504061302494c310f300d06035504080c0643656e746572310c300a06035504070c034c6f643110300e060355040a0c07476f50726f78793110300e060355040b0c07476f50726f7879311a301806035504030c11676f70726f78792e6769746875622e696f3120301e06092a864886f70d0109011611656c617a61726c40676d61696c2e636f6d301e170d3233303531353037313931305a170d3233303531353039313931305a303531163014060355040a130d4d61727469616e2050726f7879311b3019060355040313127777772e6b6172657373652e636f6d2e636e30820122300d06092a864886f70d01010105000382010f003082010a0282010100a3904c1b763fe766fb4ad3a7584fb35a5c391374a91c90ab2f4726502b8e0dd6fceef939ab1d05f3e4c2e3d7ac492e7a79b9532c80a5e18513ebe6551604d31dc96e8b8fe7a3392f66ba5754fbd246d2cac10e3f1c9b346db6ea62c6c0c9469ae805e7f541ca388ed665bfb0976bac5050c4a70be9753ccabbd974dbc1b3f2f8ecb6756852c33dc34922c6534246afdf2cf6b0d01357a2dbe333f099dad056ac0a80a6de8afe878a949a544dec6a6071af3b5b84a31ca793ebd35a296ab9c027e7b9ece3b5cc9cb044d02c7ee8715025a1e5efc12f595650f45326180bf74e478c99f82a3352705f1c57ad949cdcf9bb627ae91e53ecbe5c8063ae8a25d650c70203010001a38195308192300e0603551d0f0101ff0404030205a030130603551d25040c300a06082b06010505070301300c0603551d130101ff04023000301d0603551d0e04160414cc703be736ba68752dfc4551e109e70a4d8ff6bd301f0603551d2304183016801478b830fd63ac7b894a073bedf68a839cc3520265301d0603551d110416301482127777772e6b6172657373652e636f6d2e636e300d06092a864886f70d01010b050003820201003c20b3537a61b11530da65aed627e1034a93455673da9ecd932ac807900086e4a91175025313958a93b98a64c6c188ff8e78af0eb8d1a81577b9558945449d5e8778d687fc96e3b960ba1ab62c503a355d5c73179bdb401d9f3d3b700561869315288abd0e441ef70d4bb41498629b761ed58a32cf9c926468956be8a6502418ca35e61da0395eba132ada93d2a311eabeff0c4790a9e1aad7bf194c8495467a5854bfea438610a880f39b3758515c377a23508a939452a96bf8d3ae3f95d852e683393f8560bfa555a6981feea6cabaa11ed3b2a426a6336a67fcb152223ca70ffe2f33a634de855b2fefe4c1436936c8d98aeb953bb0f5fc41cd5f52c909987897cf7f58af40463bee5252ccea0e309ec8093b1989d0dc50e4cd4e90356c620fe080a2149a6af71ad319bbb5cf49e1693ee839cee6f85f01a4c0794efc2f851254b2d428bad1a0fb43c9a2fcf7387c04fff655350aaadb04e11bc970219808073c41144bccccf5f854c9e66abbb2a5f53e8f9923c83e8ed679111c541875274eaeb6a2162e985fc4fb942a0922da13ca51509b83e823283bfd89d424d34f09c338e64cdbd726352073d06746ab198b9983372b1788f83c7997ff3e87897d8e658195273ac87a60d65125bdd391f4b9589cf571fbddaa73a127b06647ed92fa35e673193b8b70ce7355e9152c054cbd97ef6554c3c8ae23f6a93e588f0eeb60,308205f4308203dca003020102020900e0ea614c28563264300d06092a864886f70d01010b050030818e310b300906035504061302494c310f300d06035504080c0643656e746572310c300a06035504070c034c6f643110300e060355040a0c07476f50726f78793110300e060355040b0c07476f50726f7879311a301806035504030c11676f70726f78792e6769746875622e696f3120301e06092a864886f70d0109011611656c617a61726c40676d61696c2e636f6d301e170d3137303430353230303031305a170d3337303333313230303031305a30818e310b300906035504061302494c310f300d06035504080c0643656e746572310c300a06035504070c034c6f643110300e060355040a0c07476f50726f78793110300e060355040b0c07476f50726f7879311a301806035504030c11676f70726f78792e6769746875622e696f3120301e06092a864886f70d0109011611656c617a61726c40676d61696c2e636f6d30820222300d06092a864886f70d01010105000382020f003082020a02820201009e10cbe1fa861a18d6cd1045cbc8871ae348768efd16da163debc2a727a4e805ab4ee045d23dddcd1314a4091e982fe9f78b46112f5ff62594562ee09df994cf59718638aa5285b92b5c5fc266f1faa982d980301ccfb2ab6a0e2f0cf5140628437353d2053a7095ed201e878e6c70cb88df0cfcc2b8c1707ef3aae1e4bea512619cf4df9b7d57a593ac7c9312f4f8c3e9453953766c0ffa0c0231ae306217a0e1a09aa785ad1266d0dfbfbed7a70186dc4840feaa2186262b0ebb982bbcc97444902f8e0bc3330fba956282a6a57eff981df4236e14fde75215bab5b6349811c8113ad9d2eb94761db53f6d0930ab77e28934c27e8e9f61023748bb506bfe489f538178fb864b311f547a38b41a490f2ac61dc8c9ea8f4a743e8832bcfd65e2a99ba0f226318b5aa05b9898c62579b802f4b375d1b2fdd4ae3e8cbb74235627b44cebaa02685ac273b580f0e78dcdcd2cb95befdcab85d1620b6ad5bd115b0b948acc1ece63287b21d9f014097b6c4c8c03a59404837ea6bc38add60011c9a72e3352b9d406232e3c84f30ff16e0f1e02e48c30942ebc8070196e536aa416425f49c50ad2a360e708d92a391db436382f1017ecc656e76e1d44a8938852cb60417d9d697efce2a8179eb5627016f6a9181e389c81e158a34abea3b12cd232edef931918963a89ab016335f15491f4b65b071a492bb3cb4b35aa6096134426470203010001a3533051301d0603551d0e0416041478b830fd63ac7b894a073bedf68a839cc3520265301f0603551d2304183016801478b830fd63ac7b894a073bedf68a839cc3520265300f0603551d130101ff040530030101ff300d06092a864886f70d01010b050003820201001a084ba9cc61aa71d87e2fb073857ef3c9def2cc0294a0bc45af1699637e17ca3de5731d57a0ae8502ab07d89336e468b181a77384db7dd893fbbf3a1678766d2dfb2dacf4badfc635cd98bab68cb8138f6f8988c59392740ba65c142d38558596c7acf41f026e012d3cb59dfb26e157a4919f5c93a3642432c6c7b42e0d2db8a2cc7970c293663705ad27a1eb8dc874685975cfca2528780a64542539808b328894963a3849e61a491b4eab40d7cd61ec602abaeb6848a7a348e610cb49331e53b43f378529cb0a7146041ab996413b8e05cc1352ac6c8137949673457d6643050af02243631c9e8ba33f7734afcb44ac3efcfc7d3025a6b5d1b565ad2509b181610da770effb43e6bb1fe5fa2964eca038b0c5c686c7eb6ef4ce796975feea054cf622591ff0c3b4043cbab6df20c5634e10ed49f4aa3224f04c6f698f250a45cc81cf22eec19855fbce61bd339baec47c0425dd35bc2b2e5f97909cc695420f7eb40738ba8708d88b16b7a847818203a2c454011567edf30ae42931e93905e39f8b033ed7adf229a6f54604b735ab157e93f4c158901474ff2c9ed05221f7e60f89303a581f3a3423702b9625e87baf17dec2207e427603bee42eca89f52da9338bf2940a6cdc32d12dec358bc1fa78c6bd1a51ee92950549c5a41fc0b69b6aaf80949535eb73920f2c0a807e6c24e4829cc32dc45d46ebb9ff43c33ebd60
www.karesse.com.cn
        308204e8308202d0a00302010202141b2601b2687d4e86372bc2f22e3ada3028fe378e300d06092a864886f70d01010b050030818e310b300906035504061302494c310f300d06035504080c0643656e746572310c300a06035504070c034c6f643110300e060355040a0c07476f50726f78793110300e060355040b0c07476f50726f7879311a301806035504030c11676f70726f78792e6769746875622e696f3120301e06092a864886f70d0109011611656c617a61726c40676d61696c2e636f6d301e170d3233303531353037313931305a170d3233303531353039313931305a303531163014060355040a130d4d61727469616e2050726f7879311b3019060355040313127777772e6b6172657373652e636f6d2e636e30820122300d06092a864886f70d01010105000382010f003082010a0282010100a3904c1b763fe766fb4ad3a7584fb35a5c391374a91c90ab2f4726502b8e0dd6fceef939ab1d05f3e4c2e3d7ac492e7a79b9532c80a5e18513ebe6551604d31dc96e8b8fe7a3392f66ba5754fbd246d2cac10e3f1c9b346db6ea62c6c0c9469ae805e7f541ca388ed665bfb0976bac5050c4a70be9753ccabbd974dbc1b3f2f8ecb6756852c33dc34922c6534246afdf2cf6b0d01357a2dbe333f099dad056ac0a80a6de8afe878a949a544dec6a6071af3b5b84a31ca793ebd35a296ab9c027e7b9ece3b5cc9cb044d02c7ee8715025a1e5efc12f595650f45326180bf74e478c99f82a3352705f1c57ad949cdcf9bb627ae91e53ecbe5c8063ae8a25d650c70203010001a38195308192300e0603551d0f0101ff0404030205a030130603551d25040c300a06082b06010505070301300c0603551d130101ff04023000301d0603551d0e04160414cc703be736ba68752dfc4551e109e70a4d8ff6bd301f0603551d2304183016801478b830fd63ac7b894a073bedf68a839cc3520265301d0603551d110416301482127777772e6b6172657373652e636f6d2e636e300d06092a864886f70d01010b050003820201003c20b3537a61b11530da65aed627e1034a93455673da9ecd932ac807900086e4a91175025313958a93b98a64c6c188ff8e78af0eb8d1a81577b9558945449d5e8778d687fc96e3b960ba1ab62c503a355d5c73179bdb401d9f3d3b700561869315288abd0e441ef70d4bb41498629b761ed58a32cf9c926468956be8a6502418ca35e61da0395eba132ada93d2a311eabeff0c4790a9e1aad7bf194c8495467a5854bfea438610a880f39b3758515c377a23508a939452a96bf8d3ae3f95d852e683393f8560bfa555a6981feea6cabaa11ed3b2a426a6336a67fcb152223ca70ffe2f33a634de855b2fefe4c1436936c8d98aeb953bb0f5fc41cd5f52c909987897cf7f58af40463bee5252ccea0e309ec8093b1989d0dc50e4cd4e90356c620fe080a2149a6af71ad319bbb5cf49e1693ee839cee6f85f01a4c0794efc2f851254b2d428bad1a0fb43c9a2fcf7387c04fff655350aaadb04e11bc970219808073c41144bccccf5f854c9e66abbb2a5f53e8f9923c83e8ed679111c541875274eaeb6a2162e985fc4fb942a0922da13ca51509b83e823283bfd89d424d34f09c338e64cdbd726352073d06746ab198b9983372b1788f83c7997ff3e87897d8e658195273ac87a60d65125bdd391f4b9589cf571fbddaa73a127b06647ed92fa35e673193b8b70ce7355e9152c054cbd97ef6554c3c8ae23f6a93e588f0eeb60,308205f4308203dca003020102020900e0ea614c28563264300d06092a864886f70d01010b050030818e310b300906035504061302494c310f300d06035504080c0643656e746572310c300a06035504070c034c6f643110300e060355040a0c07476f50726f78793110300e060355040b0c07476f50726f7879311a301806035504030c11676f70726f78792e6769746875622e696f3120301e06092a864886f70d0109011611656c617a61726c40676d61696c2e636f6d301e170d3137303430353230303031305a170d3337303333313230303031305a30818e310b300906035504061302494c310f300d06035504080c0643656e746572310c300a06035504070c034c6f643110300e060355040a0c07476f50726f78793110300e060355040b0c07476f50726f7879311a301806035504030c11676f70726f78792e6769746875622e696f3120301e06092a864886f70d0109011611656c617a61726c40676d61696c2e636f6d30820222300d06092a864886f70d01010105000382020f003082020a02820201009e10cbe1fa861a18d6cd1045cbc8871ae348768efd16da163debc2a727a4e805ab4ee045d23dddcd1314a4091e982fe9f78b46112f5ff62594562ee09df994cf59718638aa5285b92b5c5fc266f1faa982d980301ccfb2ab6a0e2f0cf5140628437353d2053a7095ed201e878e6c70cb88df0cfcc2b8c1707ef3aae1e4bea512619cf4df9b7d57a593ac7c9312f4f8c3e9453953766c0ffa0c0231ae306217a0e1a09aa785ad1266d0dfbfbed7a70186dc4840feaa2186262b0ebb982bbcc97444902f8e0bc3330fba956282a6a57eff981df4236e14fde75215bab5b6349811c8113ad9d2eb94761db53f6d0930ab77e28934c27e8e9f61023748bb506bfe489f538178fb864b311f547a38b41a490f2ac61dc8c9ea8f4a743e8832bcfd65e2a99ba0f226318b5aa05b9898c62579b802f4b375d1b2fdd4ae3e8cbb74235627b44cebaa02685ac273b580f0e78dcdcd2cb95befdcab85d1620b6ad5bd115b0b948acc1ece63287b21d9f014097b6c4c8c03a59404837ea6bc38add60011c9a72e3352b9d406232e3c84f30ff16e0f1e02e48c30942ebc8070196e536aa416425f49c50ad2a360e708d92a391db436382f1017ecc656e76e1d44a8938852cb60417d9d697efce2a8179eb5627016f6a9181e389c81e158a34abea3b12cd232edef931918963a89ab016335f15491f4b65b071a492bb3cb4b35aa6096134426470203010001a3533051301d0603551d0e0416041478b830fd63ac7b894a073bedf68a839cc3520265301f0603551d2304183016801478b830fd63ac7b894a073bedf68a839cc3520265300f0603551d130101ff040530030101ff300d06092a864886f70d01010b050003820201001a084ba9cc61aa71d87e2fb073857ef3c9def2cc0294a0bc45af1699637e17ca3de5731d57a0ae8502ab07d89336e468b181a77384db7dd893fbbf3a1678766d2dfb2dacf4badfc635cd98bab68cb8138f6f8988c59392740ba65c142d38558596c7acf41f026e012d3cb59dfb26e157a4919f5c93a3642432c6c7b42e0d2db8a2cc7970c293663705ad27a1eb8dc874685975cfca2528780a64542539808b328894963a3849e61a491b4eab40d7cd61ec602abaeb6848a7a348e610cb49331e53b43f378529cb0a7146041ab996413b8e05cc1352ac6c8137949673457d6643050af02243631c9e8ba33f7734afcb44ac3efcfc7d3025a6b5d1b565ad2509b181610da770effb43e6bb1fe5fa2964eca038b0c5c686c7eb6ef4ce796975feea054cf622591ff0c3b4043cbab6df20c5634e10ed49f4aa3224f04c6f698f250a45cc81cf22eec19855fbce61bd339baec47c0425dd35bc2b2e5f97909cc695420f7eb40738ba8708d88b16b7a847818203a2c454011567edf30ae42931e93905e39f8b033ed7adf229a6f54604b735ab157e93f4c158901474ff2c9ed05221f7e60f89303a581f3a3423702b9625e87baf17dec2207e427603bee42eca89f52da9338bf2940a6cdc32d12dec358bc1fa78c6bd1a51ee92950549c5a41fc0b69b6aaf80949535eb73920f2c0a807e6c24e4829cc32dc45d46ebb9ff43c33ebd60
www.karesse.com.cn
        308204e8308202d0a00302010202141b2601b2687d4e86372bc2f22e3ada3028fe378e300d06092a864886f70d01010b050030818e310b300906035504061302494c310f300d06035504080c0643656e746572310c300a06035504070c034c6f643110300e060355040a0c07476f50726f78793110300e060355040b0c07476f50726f7879311a301806035504030c11676f70726f78792e6769746875622e696f3120301e06092a864886f70d0109011611656c617a61726c40676d61696c2e636f6d301e170d3233303531353037313931305a170d3233303531353039313931305a303531163014060355040a130d4d61727469616e2050726f7879311b3019060355040313127777772e6b6172657373652e636f6d2e636e30820122300d06092a864886f70d01010105000382010f003082010a0282010100a3904c1b763fe766fb4ad3a7584fb35a5c391374a91c90ab2f4726502b8e0dd6fceef939ab1d05f3e4c2e3d7ac492e7a79b9532c80a5e18513ebe6551604d31dc96e8b8fe7a3392f66ba5754fbd246d2cac10e3f1c9b346db6ea62c6c0c9469ae805e7f541ca388ed665bfb0976bac5050c4a70be9753ccabbd974dbc1b3f2f8ecb6756852c33dc34922c6534246afdf2cf6b0d01357a2dbe333f099dad056ac0a80a6de8afe878a949a544dec6a6071af3b5b84a31ca793ebd35a296ab9c027e7b9ece3b5cc9cb044d02c7ee8715025a1e5efc12f595650f45326180bf74e478c99f82a3352705f1c57ad949cdcf9bb627ae91e53ecbe5c8063ae8a25d650c70203010001a38195308192300e0603551d0f0101ff0404030205a030130603551d25040c300a06082b06010505070301300c0603551d130101ff04023000301d0603551d0e04160414cc703be736ba68752dfc4551e109e70a4d8ff6bd301f0603551d2304183016801478b830fd63ac7b894a073bedf68a839cc3520265301d0603551d110416301482127777772e6b6172657373652e636f6d2e636e300d06092a864886f70d01010b050003820201003c20b3537a61b11530da65aed627e1034a93455673da9ecd932ac807900086e4a91175025313958a93b98a64c6c188ff8e78af0eb8d1a81577b9558945449d5e8778d687fc96e3b960ba1ab62c503a355d5c73179bdb401d9f3d3b700561869315288abd0e441ef70d4bb41498629b761ed58a32cf9c926468956be8a6502418ca35e61da0395eba132ada93d2a311eabeff0c4790a9e1aad7bf194c8495467a5854bfea438610a880f39b3758515c377a23508a939452a96bf8d3ae3f95d852e683393f8560bfa555a6981feea6cabaa11ed3b2a426a6336a67fcb152223ca70ffe2f33a634de855b2fefe4c1436936c8d98aeb953bb0f5fc41cd5f52c909987897cf7f58af40463bee5252ccea0e309ec8093b1989d0dc50e4cd4e90356c620fe080a2149a6af71ad319bbb5cf49e1693ee839cee6f85f01a4c0794efc2f851254b2d428bad1a0fb43c9a2fcf7387c04fff655350aaadb04e11bc970219808073c41144bccccf5f854c9e66abbb2a5f53e8f9923c83e8ed679111c541875274eaeb6a2162e985fc4fb942a0922da13ca51509b83e823283bfd89d424d34f09c338e64cdbd726352073d06746ab198b9983372b1788f83c7997ff3e87897d8e658195273ac87a60d65125bdd391f4b9589cf571fbddaa73a127b06647ed92fa35e673193b8b70ce7355e9152c054cbd97ef6554c3c8ae23f6a93e588f0eeb60,308205f4308203dca003020102020900e0ea614c28563264300d06092a864886f70d01010b050030818e310b300906035504061302494c310f300d06035504080c0643656e746572310c300a06035504070c034c6f643110300e060355040a0c07476f50726f78793110300e060355040b0c07476f50726f7879311a301806035504030c11676f70726f78792e6769746875622e696f3120301e06092a864886f70d0109011611656c617a61726c40676d61696c2e636f6d301e170d3137303430353230303031305a170d3337303333313230303031305a30818e310b300906035504061302494c310f300d06035504080c0643656e746572310c300a06035504070c034c6f643110300e060355040a0c07476f50726f78793110300e060355040b0c07476f50726f7879311a301806035504030c11676f70726f78792e6769746875622e696f3120301e06092a864886f70d0109011611656c617a61726c40676d61696c2e636f6d30820222300d06092a864886f70d01010105000382020f003082020a02820201009e10cbe1fa861a18d6cd1045cbc8871ae348768efd16da163debc2a727a4e805ab4ee045d23dddcd1314a4091e982fe9f78b46112f5ff62594562ee09df994cf59718638aa5285b92b5c5fc266f1faa982d980301ccfb2ab6a0e2f0cf5140628437353d2053a7095ed201e878e6c70cb88df0cfcc2b8c1707ef3aae1e4bea512619cf4df9b7d57a593ac7c9312f4f8c3e9453953766c0ffa0c0231ae306217a0e1a09aa785ad1266d0dfbfbed7a70186dc4840feaa2186262b0ebb982bbcc97444902f8e0bc3330fba956282a6a57eff981df4236e14fde75215bab5b6349811c8113ad9d2eb94761db53f6d0930ab77e28934c27e8e9f61023748bb506bfe489f538178fb864b311f547a38b41a490f2ac61dc8c9ea8f4a743e8832bcfd65e2a99ba0f226318b5aa05b9898c62579b802f4b375d1b2fdd4ae3e8cbb74235627b44cebaa02685ac273b580f0e78dcdcd2cb95befdcab85d1620b6ad5bd115b0b948acc1ece63287b21d9f014097b6c4c8c03a59404837ea6bc38add60011c9a72e3352b9d406232e3c84f30ff16e0f1e02e48c30942ebc8070196e536aa416425f49c50ad2a360e708d92a391db436382f1017ecc656e76e1d44a8938852cb60417d9d697efce2a8179eb5627016f6a9181e389c81e158a34abea3b12cd232edef931918963a89ab016335f15491f4b65b071a492bb3cb4b35aa6096134426470203010001a3533051301d0603551d0e0416041478b830fd63ac7b894a073bedf68a839cc3520265301f0603551d2304183016801478b830fd63ac7b894a073bedf68a839cc3520265300f0603551d130101ff040530030101ff300d06092a864886f70d01010b050003820201001a084ba9cc61aa71d87e2fb073857ef3c9def2cc0294a0bc45af1699637e17ca3de5731d57a0ae8502ab07d89336e468b181a77384db7dd893fbbf3a1678766d2dfb2dacf4badfc635cd98bab68cb8138f6f8988c59392740ba65c142d38558596c7acf41f026e012d3cb59dfb26e157a4919f5c93a3642432c6c7b42e0d2db8a2cc7970c293663705ad27a1eb8dc874685975cfca2528780a64542539808b328894963a3849e61a491b4eab40d7cd61ec602abaeb6848a7a348e610cb49331e53b43f378529cb0a7146041ab996413b8e05cc1352ac6c8137949673457d6643050af02243631c9e8ba33f7734afcb44ac3efcfc7d3025a6b5d1b565ad2509b181610da770effb43e6bb1fe5fa2964eca038b0c5c686c7eb6ef4ce796975feea054cf622591ff0c3b4043cbab6df20c5634e10ed49f4aa3224f04c6f698f250a45cc81cf22eec19855fbce61bd339baec47c0425dd35bc2b2e5f97909cc695420f7eb40738ba8708d88b16b7a847818203a2c454011567edf30ae42931e93905e39f8b033ed7adf229a6f54604b735ab157e93f4c158901474ff2c9ed05221f7e60f89303a581f3a3423702b9625e87baf17dec2207e427603bee42eca89f52da9338bf2940a6cdc32d12dec358bc1fa78c6bd1a51ee92950549c5a41fc0b69b6aaf80949535eb73920f2c0a807e6c24e4829cc32dc45d46ebb9ff43c33ebd60
`
	res := make(map[string]*x509.Certificate)
	iterator := NewLineIterator(code)
	for iterator.HasNext() {
		host, _ := iterator.Get()
		if host == "" {
			continue
		}
		if strings.Contains(host, ",") {
			continue
		}
		host = strings.TrimSpace(host)

		line, _ := iterator.Next()
		if !strings.Contains(line, ",") {
			continue
		}

		fields := strings.Split(strings.TrimSpace(line), ",")
		if len(fields) != 2 {
			continue
		}

		data, err := hex.DecodeString(fields[0])
		if err != nil {
			continue
		}
		cert, err := x509.ParseCertificate(data)
		if err != nil {
			continue
		}

		_, ok := res[host]
		if !ok {
			res[host] = cert
		}
	}
	fmt.Println(res)
}

package tls

import (
	"crypto/md5"
	"crypto/x509"
	"encoding/hex"
	"testing"
)

func TestXxx(t *testing.T) {
	payload := "3082067c30820564a00302010202100a713d7857d38edae3f6b907a8b43612300d06092a864886f70d01010b0500305b310b300906035504061302555331153013060355040a130c446967694365727420496e6331193017060355040b13107777772e64696769636572742e636f6d311a3018060355040313115365637572652053697465204341204732301e170d3233303130353030303030305a170d3234303230353233353935395a3053310b300906035504061302434e3111300f060355040813085368616e67686169311b3019060355040a1312416c697061792e636f6d20436f2e2c4c74643114301206035504030c0b2a2e79757175652e636f6d30820122300d06092a864886f70d01010105000382010f003082010a02820101009940305155b1e73cd8462770345e17599f76378192638c02af3e3022faf3d37758206dd74baede6e219cb379e88dd1f29be170e2465deec21781633a836ccf1fa6d954b6ff38688c6cc9e85a6ae59abfd8c9a0d8469f53eb944581dc6b24c4dbdae6e16510cd6b6224ed64198685511d30f9a71ab96dd51553c4aac66dcd3a63c67b29bf5796bb7c3716b5211c2488476b93fd202d09d33649eaa36ad3bc936cf95665c77ca293e3c39e4e3fbb698a8cb14e56e42d97909929f882423babf1a4561ebb59c8db3ccfb0624d1431d58e33b6ff47abc00ce05b562feecfae837c7145de7f92c0538ead0109ebbdd299d660ec246f273f85ed71671aaeb7fc260a1f0203010001a38203423082033e301f0603551d23041830168014c4117e884086c241bf65f31ae1b45340a3abec7d301d0603551d0e041604149fbd40ba6f69c680b7e483f0eceef98a88ee20da30210603551d11041a3018820b2a2e79757175652e636f6d820979757175652e636f6d300e0603551d0f0101ff0404030205a0301d0603551d250416301406082b0601050507030106082b06010505070302306f0603551d1f046830663031a02fa02d862b687474703a2f2f63726c332e64696769636572742e636f6d2f53656375726553697465434147322e63726c3031a02fa02d862b687474703a2f2f63726c342e64696769636572742e636f6d2f53656375726553697465434147322e63726c303e0603551d20043730353033060667810c0102023029302706082b06010505070201161b687474703a2f2f7777772e64696769636572742e636f6d2f435053306c06082b060105050701010460305e302106082b060105050730018615687474703a2f2f6f6373702e64636f6373702e636e303906082b06010505073002862d687474703a2f2f63726c2e64696769636572742d636e2e636f6d2f53656375726553697465434147322e63727430090603551d13040230003082017e060a2b06010401d6790204020482016e0482016a016800750076ff883f0ab6fb9551c261ccf587ba34b4a4cdbb29dc68420a9fe6674c5a3a740000018580169dd00000040300463044022002f456a919751f606415121fe81493cae48593e8ff5bddbcb944cf790f0719500220272e0ecfc2a9c72708ab9763b17d964131b8b9fa06706332ec865c95080f0f4000760048b0e36bdaa647340fe56a02fa9d30eb1c5201cb56dd2c81d9bbbfab39d884730000018580169d9a000004030047304502205c737f284d801f3c1fd37d952ac21a48a14b5dcdafc5d2b199a21071d95d8f00022100f5ce33c6928673cbc9bae1969c8c40189e18ee48dce8a685759ecc8c10bcd9af0077003b5377753e2db9804e8b305b06fe403b67d84fc3f4c7bd000d2d726fe1fad4170000018580169d920000040300483046022100d48765da32c70e23441059072347c0c11c62c99d2e69a06095480067756b7c7a02210083d951366a969b1622b98a07a314b9a5cadccf402a250141791eed512265380e300d06092a864886f70d01010b0500038201010044fc9c7f86c0f1b4677ddf5e49c39e4e775038e0b93387e58fb0330df50845ab9f55907692230de8ed932c9b372bd7242dd4aa03c61a21167355158cbe6b06f755f5f381987533a9af994625524964cb3b21b2c31a95586e89285d8136f7fb000cb8987b0d7d22e700628ea86ba2f08c7274b72228485ed46b9685435b30322de230b4a5e30c01d45f24c7fcae78a754d0ec84306c788da6595318a9f5a8712435477a2b34d5aef576bc82a020e15d90a6f03c2f61bf31a1f9b34362fe79381567d9d250fc3da4592d0836feb016dee89287c2631c309e4d3f02c099820f66834e7550998bfef3ecdd777c5f493ba1b8f874528df32ec0dc19de84659f334adc"
	data, err := hex.DecodeString(payload)
	if err != nil {
		panic(err)
	}

	c, err := x509.ParseCertificate(data)
	if err != nil {
		panic(err)
	}

	t.Log("Version:", c.Version)
	t.Log("SerialNumber", hex.EncodeToString(c.SerialNumber.Bytes()))
	t.Log("Thumbprint:", MD5(data))
	t.Log(c.Issuer.String())
	t.Log(c.Subject.String())
}

// return md5 hash
func MD5(s []byte) string {
	h := md5.New()
	h.Write(s)
	return hex.EncodeToString(h.Sum(nil))
}
